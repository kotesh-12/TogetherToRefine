allotment.html
 <!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Class Allotment</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f4f4f4; }
    .announcement-bar {
      background: linear-gradient(to right, #ff6b6b, #ff9f43);
      color: white;
      padding: 10px;
      overflow: hidden;
      white-space: nowrap;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .scrolling-text {
      display: inline-block;
      padding-left: 100%;
      animation: scroll-left 15s linear infinite;
    }
    @keyframes scroll-left {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }
    .container { max-width: 1000px; margin: 20px auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    h2 { text-align: center; margin-bottom: 20px; }
    .select-group { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; }
    select { padding: 10px; font-size: 16px; }
    .role-buttons { display: flex; justify-content: space-between; margin-bottom: 20px; }
    .role-buttons button { width: 48%; padding: 10px; font-size: 16px; border: none; border-radius: 5px; cursor: pointer; }
    .teacher-btn { background-color: #0984e3; color: white; }
    .student-btn { background-color: #00b894; color: white; }
    .entry { display: flex; justify-content: space-between; padding: 10px; margin: 5px 0; background: #ecf0f1; border-radius: 5px; }
    .entry span { font-weight: bold; }
    .entry button { background: #d63031; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; }
    .form-inline { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
    .form-inline input { padding: 8px; flex: 1; min-width: 180px; }
    .form-inline button { padding: 8px 15px; background: #2ecc71; color: white; border: none; border-radius: 5px; cursor: pointer; }
    .new-admission { text-align: center; margin-top: 20px; }
    .new-admission button { padding: 10px 20px; font-size: 16px; background: #6c5ce7; color: white; border: none; border-radius: 5px; cursor: pointer; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div class="announcement-bar">
    <div class="scrolling-text">üì¢ Attention: Assign teachers and students only after proper feedback and evaluation process!</div>
  </div>
  <div class="container">
    <h2>üìò Class & Section Allotment</h2><div class="select-group">
  <select id="classSelect">
    <option value="">Select Class</option>
    <option value="Nursery">Nursery</option>
    <option value="LKG">LKG</option>
    <option value="UKG">UKG</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
  </select>

  <select id="sectionSelect">
    <option value="">Select Section</option>
    <option value="A">A</option>
    <option value="B">B</option>
    <option value="C">C</option>
    <option value="D">D</option>
  </select>
</div>

<div class="role-buttons">
  <button class="teacher-btn" onclick="toggleRole('teacher')">üë®‚Äçüè´ Teachers</button>
  <button class="student-btn" onclick="toggleRole('student')">üë©‚Äçüéì Students</button>
</div>

<div id="roleSection" class="hidden">
  <div id="entryContainer"></div>
  <div id="addForm" class="form-inline">
    <input type="text" id="nameInput" placeholder="Enter Name">
    <input type="text" id="extraInput" placeholder="Enter Subject or Age">
    <button onclick="addEntry()">Add</button>
  </div>
</div>

<div class="new-admission">
  <button onclick="window.location.href='admission.html'">‚ûï New Admission</button>
</div>

  </div>  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, query, where, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDWHnST2fHu2xgtL3tu7WQ0bJZ6AMzfPbY",
  authDomain: "together-to-refine.firebaseapp.com",
  projectId: "together-to-refine",
  storageBucket: "together-to-refine.appspot.com",
  messagingSenderId: "902921672660",
  appId: "1:902921672660:web:ca8db0c1d99e42159b70aa"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Optional: Show login status at top
const statusEl = document.createElement("p");
statusEl.style.color = "red";
document.body.prepend(statusEl);

onAuthStateChanged(auth, async (user) => {
  if (user) {
    statusEl.textContent = "‚úÖ Logged in UID: " + user.uid;

    // Optional: check role
    const userDoc = await getDoc(doc(db, "users", user.uid));
    if (!userDoc.exists() || userDoc.data().role !== "institution") {
      alert("‚ùå Access denied. Not an institution.");
    }

  } else {
    statusEl.textContent = "‚ùå Not logged in.";
  }
});
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    let currentRole = null;

    window.toggleRole = async function(role) {
      const section = document.getElementById("roleSection");
      if (currentRole === role && !section.classList.contains("hidden")) {
        section.classList.add("hidden");
        currentRole = null;
        return;
      }
      currentRole = role;
      section.classList.remove("hidden");
      await showRole(role);
    }

    async function showRole(role) {
      const cls = document.getElementById('classSelect').value;
      const sec = document.getElementById('sectionSelect').value;
      if (!cls || !sec) return alert("Please select class and section");

      document.getElementById('entryContainer').innerHTML = '';
      document.getElementById('nameInput').value = '';
      document.getElementById('extraInput').value = '';

      const colName = role === 'teacher' ? 'teacher_allotments' : 'student_allotments';
      const q = query(collection(db, colName), where('classAssigned', '==', cls), where('section', '==', sec));
      const snapshot = await getDocs(q);
      const container = document.getElementById('entryContainer');
      snapshot.forEach(docSnap => {
        const data = docSnap.data();
        const div = document.createElement('div');
        div.className = 'entry';
        div.innerHTML = `<span>${data.name} - ${role === 'teacher' ? data.subject : data.age}</span>
          <button onclick="deleteEntry('${colName}', '${docSnap.id}')">Delete</button>`;
        container.appendChild(div);
      });
    }

    window.addEntry = async function () {
      const cls = document.getElementById('classSelect').value;
      const sec = document.getElementById('sectionSelect').value;
      const name = document.getElementById('nameInput').value;
      const extra = document.getElementById('extraInput').value;
      if (!name || !extra || !cls || !sec || !currentRole) return alert("Fill all fields");

      const docData = {
        name,
        classAssigned: cls,
        section: sec,
        [currentRole === 'teacher' ? 'subject' : 'age']: extra
      };
      const colName = currentRole === 'teacher' ? 'teacher_allotments' : 'student_allotments';
      await addDoc(collection(db, colName), docData);
      await showRole(currentRole);
    }

    window.deleteEntry = async function (col, id) {
      if (confirm("Delete this entry?")) {
        await deleteDoc(doc(db, col, id));
        await showRole(currentRole);
      }
    }
  </script></body>
</html>